# Feature Specification: 菜单标签页导航

**Feature Branch**: `004-menu-breadcrumb`
**Created**: 2026-02-04
**Status**: Draft
**Input**: User description: "新增管理系统 layout 内容区域顶部的菜单 tab"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 查看已打开的页面标签 (Priority: P1)

用户在管理系统中浏览不同页面时，顶部标签栏显示所有已访问的页面标签，方便用户了解当前打开了哪些页面，并快速识别当前所在页面。

**Why this priority**: 这是标签页导航的核心功能，没有标签显示就没有多标签页的意义。

**Independent Test**: 可以通过访问多个菜单页面，验证标签栏是否正确显示所有已访问页面的标签。

**Acceptance Scenarios**:

1. **Given** 用户已登录并访问用户管理页面, **When** 页面加载完成, **Then** 标签栏显示 "用户管理" 标签且为激活状态
2. **Given** 用户已打开用户管理页面, **When** 用户点击侧边栏访问角色管理, **Then** 标签栏新增 "角色管理" 标签且为激活状态，"用户管理" 标签保留
3. **Given** 用户首次登录, **When** 进入 Dashboard, **Then** 标签栏显示 "首页" 标签作为默认标签

---

### User Story 2 - 点击标签切换页面 (Priority: P1)

用户可以点击标签栏中的任意标签快速切换到对应页面，无需通过侧边栏菜单重新查找，提高多任务操作效率。

**Why this priority**: 标签页的核心交互价值在于快速切换，这是用户使用标签页的主要目的。

**Independent Test**: 可以通过打开多个页面后，点击不同标签验证是否正确切换到对应页面。

**Acceptance Scenarios**:

1. **Given** 用户已打开用户管理和角色管理两个页面, **When** 点击 "用户管理" 标签, **Then** 页面切换到用户管理，该标签变为激活状态
2. **Given** 用户在角色管理页面, **When** 点击当前激活的 "角色管理" 标签, **Then** 页面不发生变化（已是当前页）
3. **Given** 用户打开了 5 个页面标签, **When** 依次点击各标签, **Then** 每次都能正确切换到对应页面

---

### User Story 3 - 关闭标签页 (Priority: P2)

用户可以关闭不再需要的标签页，保持标签栏整洁，只保留当前工作相关的页面。

**Why this priority**: 关闭功能是标签页管理的重要组成部分，但即使没有关闭功能，切换功能仍然可用。

**Independent Test**: 可以通过点击标签上的关闭按钮，验证标签是否被正确移除。

**Acceptance Scenarios**:

1. **Given** 用户已打开用户管理和角色管理两个标签, **When** 点击 "用户管理" 标签的关闭按钮, **Then** "用户管理" 标签被移除，页面切换到 "角色管理"
2. **Given** 用户只有一个 "首页" 标签, **When** 尝试关闭 "首页" 标签, **Then** 首页标签不可关闭（固定标签）
3. **Given** 用户当前在 "角色管理" 页面, **When** 关闭 "用户管理" 标签（非当前标签）, **Then** 标签被移除，当前页面不变

---

### User Story 4 - 右键菜单操作 (Priority: P3)

用户可以通过右键点击标签弹出上下文菜单，执行批量操作如关闭其他标签、关闭右侧标签等。

**Why this priority**: 这是高级功能，提升效率但非核心必需。

**Independent Test**: 可以通过右键点击标签，验证菜单是否正确显示并执行对应操作。

**Acceptance Scenarios**:

1. **Given** 用户已打开 5 个标签, **When** 右键点击中间的标签, **Then** 显示上下文菜单（关闭当前、关闭其他、关闭右侧、关闭左侧）
2. **Given** 用户右键点击某标签并选择 "关闭其他", **When** 确认操作, **Then** 除当前标签和首页外的所有标签被关闭
3. **Given** 用户右键点击某标签并选择 "关闭右侧", **When** 确认操作, **Then** 该标签右侧的所有标签被关闭

---

### Edge Cases

- 当标签数量过多超出容器宽度时如何处理？应支持横向滚动或显示左右箭头
- 当用户刷新页面时，已打开的标签如何处理？可选择持久化到本地存储或重置为仅首页
- 当用户访问隐藏菜单页面（如字典数据详情）时，标签如何显示？应显示该页面的标题
- 当用户关闭当前激活的标签时，应切换到哪个标签？切换到相邻标签（优先右侧，无则左侧）

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 系统 MUST 在 layout 内容区域顶部显示标签栏组件
- **FR-002**: 标签栏 MUST 显示所有已访问页面的标签
- **FR-003**: 每个标签 MUST 显示对应页面的标题（title）
- **FR-004**: 当前页面的标签 MUST 以激活状态样式显示，与其他标签有明显区分
- **FR-005**: 用户 MUST 能够点击标签切换到对应页面
- **FR-006**: 用户 MUST 能够关闭非固定标签（首页为固定标签不可关闭）
- **FR-007**: 标签栏 MUST 在路由变化时自动同步更新（新增或激活对应标签）
- **FR-008**: 标签栏 MUST 支持动态路由（从后端加载的菜单）
- **FR-009**: 当标签数量超出容器宽度时，MUST 提供滚动或导航机制
- **FR-010**: 标签栏 MUST 适配深色模式和浅色模式的主题切换
- **FR-011**: 用户 SHOULD 能够通过右键菜单执行批量关闭操作
- **FR-012**: 标签状态 SHOULD 在页面刷新后保持（持久化到本地存储）

### Key Entities

- **Tab Item**: 标签项，包含标题（title）、路径（path）、是否固定（fixed）、是否激活（active）
- **Tab Store**: 标签状态管理，维护已打开标签列表和当前激活标签

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 用户通过标签切换页面的操作步骤不超过 1 次点击
- **SC-002**: 标签在路由变化后 300ms 内完成更新
- **SC-003**: 标签栏在所有支持的主题模式下都能清晰可读
- **SC-004**: 标签功能覆盖 100% 的可访问菜单页面
- **SC-005**: 用户可以同时打开至少 20 个标签而不影响使用体验

## Assumptions

- 首页（Dashboard）作为固定标签，始终显示且不可关闭
- 标签按访问顺序排列，新标签添加到末尾
- 标签栏放置在 header 下方、main content 上方
- 使用 Pinia 管理标签状态
- 标签数据持久化到 localStorage
